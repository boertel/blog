---
layout: post
title: Remix HMR was slow
permalink: "remix-slow-hmr"
---

My Remix app had a really slow HMR, about 4 seconds for each change.

1. A quick search lead me to this [rebuilding take too long](https://github.com/remix-run/remix/discussions/6539) GitHub issue which matches the behavior I'm seeing.
2. It is talking about bundle size and mentions [Remix Documentation - Performance](https://remix.run/docs/en/main/guides/performance) page.
3. There it explains you can analyze a bundle thanks to `./build/metafile*` files generated by `npx remix build`.
4. Head over to [esbuild.github.io/analyze/](https://esbuild.github.io/analyze/)
5. Upload your file. It allows only 1 file!
6. Something might be obvious!

![](/media/notes/1.png)

Two culprits:

1. [Sevilla FC emblem](https://en.wikipedia.org/wiki/Sevilla_FC#/media/File:Sevilla_FC_logo.svg) weights 2.1 mb.
2. We are embedding node `crypto` module inside the browser bundle. We were importing some server side libraries for the action at the top level. Moving these pieces of code inside `*.server.ts` file [solved it](https://remix.run/docs/en/1.19.3/pages/gotchas#server-code-in-client-bundles).

![](/media/notes/2.png)

We are rebuilding our Remix app 530ms ðŸŽ‰!

Next is going to be moving the SVG flags and emblems outside of the bundle into a "SVG sprites".
